!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){var r=n(2),o=n(3),c=n(4);e.exports=function(e,t){return r(e)||o(e,t)||c()}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,c=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,c=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw c}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(1),a=n.n(c),i={second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2628e6,year:31536e6,months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],max:new Date(864e13),min:new Date(-864e13)};function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e){return e.getTime()==i.max.getTime()||e.getTime()==i.min.getTime()}(e)?"—":(Math.abs(Date.now()-e.getTime())<=i.week)-t?i.days[e.getDay()]:"".concat((e.getDate()+"").padStart(2,0)," ").concat(i.months[e.getMonth()]," ").concat((e.getFullYear()+"").slice(-2))}function d(e,t){return"".concat(e).concat(t>1?"s":"")}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(e+"").padStart(t,0)}var l={fromNow:function(e){var t=Math.abs(Date.now()-e);if(t<i.second)return"".concat(t,"ms");var n=t/i.second|0;if(t<i.minute)return"".concat(s(n)," ").concat(d("second",n));var r=n/60|0;if(t<i.hour)return"".concat(s(r),":").concat(s(n%60)," ").concat(d("minute",r));var o=n/3600|0;if(r%=60,t<i.day)return"".concat(s(o),":").concat(s(r)," ").concat(d("hour",o));var c=n/86400|0;if(t<i.week)return(o%=24)?"".concat(s(c)," ").concat(d("day",c)," ").concat(s(o)," ").concat(d("hour",o)):"".concat(s(c)," ").concat(d("day",c));var a=n/604800|0;if(t<i.month)return(c%=7)?"".concat(s(a)," ").concat(d("week",a)," ").concat(s(c)," ").concat(d("day",c)):"".concat(s(a)," ").concat(d("week",a));var u=n/2628e3|0;if(console.log(c),t<i.year)return(c=c%30.42|0)?"".concat(s(u)," ").concat(d("month",u)," ").concat(s(c)," ").concat(d("day",c)):"".concat(s(u)," ").concat(d("month",u));var l=n/31536e3|0;u%=12,c=c%365%31;var f="".concat(s(l)," ").concat(d("year",l));return u&&(f+=" ".concat(s(u)," ").concat(d("month",u))),c&&(f+=" ".concat(s(c)," ").concat(d("day",c))),f},closestToNow:function(e,t){var n=Date.now();return Math.abs(t-n)-Math.abs(e-n)}};function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var p={shows:0},h="embed[]=nextepisode&embed[]=previousepisode&embed[]=seasons",m={"To Be Determined":"TBD","In Development":"Dev"},v=new Event("change"),y=0,g={setup:function(e){e.onmousedown=function(e){y=e.which},e.onmouseup=function(){y=0}},showPreview:function(e){var t=S(e,!0),n=document.createElement("div");return n.title="Premiere date",n.innerText=u(e.premiered),t.insertBefore(n,t.children[1]),t.parentElement},showFull:function(e,t,n){var r=S(e),o=document.createElement("p"),c=document.createElement("div"),a=document.createElement("div"),i=document.createElement("p"),d=document.createElement("div"),s=document.createElement("div"),l=document.createElement("p"),f=document.createElement("div");return a.innerText=u(e.next.date),s.innerText=u(e.prev.date),i.innerText=e.next.ep,l.innerText=e.prev.ep,f.innerText=e.seasons,a.onmouseenter=function(){return a.innerText=u(e.next.date,!0)},a.onmouseleave=function(){return a.innerText=u(e.next.date)},s.onmouseenter=function(){return s.innerText=u(e.prev.date,!0)},s.onmouseleave=function(){return s.innerText=u(e.prev.date)},i.onmouseenter=function(){return i.innerText=e.next.left},i.onmouseleave=function(){return i.innerText=e.next.ep},l.onmouseenter=function(){return l.innerText=e.prev.left},l.onmouseleave=function(){return l.innerText=e.prev.ep},c.appendChild(a),c.appendChild(i),d.appendChild(s),d.appendChild(l),r.parentElement.querySelector("input").onchange=function(e){(p.shows+=e.target.checked||-1)?(t.style.display="flex",n.text.innerText="".concat(p.shows," Show").concat(p.shows>1?"s":""," selected")):t.style.display="none"},r.firstChild.insertAdjacentElement("afterbegin",o),r.insertBefore(c,r.children[1]),r.insertBefore(d,r.children[2]),r.insertBefore(f,r.children[5]),r.parentElement},showSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(){return b("https://api.tvmaze.com/search/shows?q=".concat(t),e)}},singleShowSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(){return b("https://api.tvmaze.com/singlesearch/shows?q=".concat(t,"&").concat(h),e)}},searchShowByID:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){return b("https://api.tvmaze.com/shows/".concat(t,"?").concat(h),e)}},getShowInfo:function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id,name:e.name,network:e.network&&e.network.name||e.webChannel&&e.webChannel.name||"—",status:m[e.status]||e.status||"—",rating:e.rating&&e.rating.average||0,premiered:e.premiered&&new Date("".concat(e.premiered,"T00:00:00"))||i.min},function(e){var t={next:{ep:"TBD",date:i.min,left:"SECRET"},prev:{ep:"TBD",date:i.min,left:"SECRET"},seasons:"—"};if(!e._embedded)return t;return t.seasons=e._embedded.seasons.length,[{short:"next",long:"nextepisode"},{short:"prev",long:"previousepisode"}].forEach((function(n){var r,o,c;if((c=e._embedded[n.long])?(t[n.short].ep=w(r=c.season,o=c.number),t[n.short].date=new Date(c.airstamp)):(c=e._embedded.previousepisode)&&t.seasons>c.season&&(t[n.short].ep=w(r=c.season+1,o=1)),r&&(c=e._embedded.seasons[r-1].episodeOrder)){var a=c-o;t[n.short].left=a&&a+" LEFT"||"LAST"}})),t.seasons=(t.seasons+"").padStart(2,0),t}(e))}};function w(e,t){return"S".concat((e+"").padStart(2,0),"E").concat((t+"").padStart(2,0))}function S(e,t){var n=document.createElement("label"),r=document.createElement("input"),o=document.createElement("li"),c=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),u=document.createElement("div");return r.type="checkbox",r.hidden=!0,t&&(c.title="Name",a.title="Network",i.title="Status",u.title="Rating"),c.innerHTML="<div>".concat(e.name,"</div>"),a.innerText=e.network,i.innerText=e.status,u.innerText=e.rating&&e.rating.toFixed(1)||"—",n.appendChild(r),n.appendChild(o),o.appendChild(c),o.appendChild(a),o.appendChild(i),o.appendChild(u),n.id=e.id,n.onmouseover=function(){1==y&&(r.checked^=!0,r.dispatchEvent(v))},n.onmousedown=function(e){1==e.which&&(r.checked^=!0,r.dispatchEvent(v))},n.onclick=function(){return!1},o}function b(e,t){return fetch(e).then((function(e){return 200==e.status&&e.json()})).then((function(e){t(e)})),!0}var x=[];x.addListener=function(e,t){return x["on".concat(e)]=t},["push","splice","sort"].forEach((function(e){x[e]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){for(var n,r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];var a=(n=Array.prototype[e]).call.apply(n,[x].concat(o));return x["on".concat(e)].apply(x,o.concat([a])),x.onchange(t),E(),a}}(e,"splice"==e)})),x.at=function(e,t){if(!(e>=x.length))return x[e]=t,x.onedit(t,e),E(),t};var T={getDivs:function(e){return e.querySelectorAll("div").reduce((function(e,t,n){return 0!=n&&2!=n&&4!=n&&e.push(t),e}),[])},updateButton:function(){var e=document.createElement("div"),t=document.createElement("button");return t.innerText="Update all",t.type="button",e.appendChild(t),e},clearNode:function(e){for(;e.firstChild&&!e.firstChild.remove(););},timeout:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return setTimeout(e,333*t)}};function E(){localStorage.setItem("showList",JSON.stringify(x))}var D,O=(D=localStorage.getItem("lastUpdated"))?new Date(D):(localStorage.setItem("lastUpdated",new Date(Date.now())),new Date(Date.now()));document.title="TVSM Updated ".concat(l.fromNow(O)," ago"),document.onreadystatechange=function(){return"interactive"==document.readyState&&function(){var e,t=document.querySelector(".content"),n=document.querySelector("p"),r=document.querySelector("form"),c=document.querySelector("input"),a=document.querySelectorAll("ul"),i=o()(a,4),u=i[1],d=i[2],s=i[3],f=document.querySelector("#sel-menu"),h={remove:f.querySelector("button"),update:f.querySelector("button:last-child"),text:f.querySelector("div")};NodeList.prototype.reduce=Array.prototype.reduce,x.addListener("change",(function(e){T.timeout((function(){return s.childNodes.forEach((function(e,t){return e.querySelector("p").innerText=(t+1+"").padStart(2,0)}))}),e)})),x.addListener("push",(function(e,t){var n=g.showFull(e,f,h);s.appendChild(n),n.classList.add("added"),T.timeout((function(){return n.classList.remove("added")}))})),x.addListener("edit",(function(e,t){var n=g.showFull(e,f,h),r=s.children[t];n.querySelector("p").replaceWith(r.querySelector("p")),n.querySelector("input").checked=r.querySelector("input").checked;var o=T.getDivs(r);T.getDivs(n).forEach((function(e,t){o[t].innerText!=e.innerText&&e.classList.add("changed")})),r.replaceWith(n),n.classList.add("updated"),T.timeout((function(){return n.classList.remove("updated")}))})),x.addListener("sort",(function(e,t){var n=Object.values(s.childNodes);n.forEach((function(e){return e.remove()})),t.forEach((function(e){return s.appendChild(n.find((function(t){return t.id==e.id})))}))})),x.addListener("splice",(function(e,t){for(var n=s.childNodes,r=function(e){e.className="removed",T.timeout((function(){return e.remove()})),t--},o=n[e];t;o=n[++e])r(o)})),n.onclick=w,h.remove.onclick=function(){s.childNodes.reduce((function(e,t,n){return t.firstChild.checked&&e.push(n),e}),[]).reverse().reduce((function(e,t,n,r){if(n==r.length-1)x.splice(t,e);else{if(t==r[n+1]+1)return++e;x.splice(t,e)}return 1}),1),f.style.display="none",p.shows=0},h.update.onclick=function(){s.childNodes.reduce((function(e,t,n){return t.querySelector("input").checked&&e.push([t.id,n]),e}),[]).forEach((function(e,t){return T.timeout(g.searchShowByID((function(t){x.at(e[1],g.getShowInfo(t))}),e[0]),t)}))};var m={};["name","network","status"].forEach((function(e){m[e]=function(t){return x.sort((function(n,r){return(t||-1)*-n[e].localeCompare(r[e])}))}})),["seasons","rating"].forEach((function(e){m[e]=function(t){return x.sort((function(n,r){return(t||-1)*(n[e]+"").localeCompare(r[e]+"")}))}})),["next","prev"].forEach((function(e){m[e]=function(t){return x.sort((function(n,r){return t?l.closestToNow(n[e].date.getTime(),r[e].date.getTime()):l.closestToNow(r[e].date.getTime(),n[e].date.getTime())}))}}));var v,y=["name","next","prev","network","status","seasons","rating"];function w(){var e=T.updateButton();return t.style.justifyContent="normal",n.remove(),a.forEach((function(e){return e.hidden=!1})),r.classList.add("navbar"),r.querySelector(".input-wrapper").insertAdjacentElement("afterbegin",e),e.querySelector("button").onclick=function(){x.forEach((function(e,t){T.timeout(g.searchShowByID((function(e){x.at(t,g.getShowInfo(e))}),e.id),t)})),T.timeout((function(){O=new Date(Date.now()),localStorage.setItem("lastUpdated",O),document.title="TVSM Updated ".concat(l.fromNow(O)," ago")}),x.length)},!0}function S(){function e(e){var t=x.findIndex((function(t){return t.id==e.id}));e=g.getShowInfo(e),-1==t&&x.push(e)||x.at(t,e)}"#"==c.value.trim()[0]?(c.value.slice(1).split(",").forEach((function(t,n){return T.timeout(g.singleShowSearch(e,t),n)})),c.value=""):(u.childNodes.forEach((function(t,n){return t.firstChild.checked&&T.timeout(g.searchShowByID(e,t.id),n)})),u.firstChild&&!(c.value="")&&T.clearNode(u));return!1}d.querySelectorAll("div").forEach((function(e,t){var n=y[t];e.onclick=function(){var e=d.getAttribute("sortBy")==n;m[n](e),d.setAttribute("sortBy",e?"none":n)}})),c.oninput=function(){T.clearNode(u),clearTimeout(e);var t=c.value.trim();t&&"#"!=t[0]&&(e=T.timeout(g.showSearch((function(e){e.length&&(e.forEach((function(e){return u.appendChild(g.showPreview(g.getShowInfo(e.show)))})),u.firstChild.firstChild.checked=!0)}),t)))},(v=localStorage.getItem("showList"))?(JSON.parse(v).forEach((function(e){e.next.date=new Date(e.next.date),e.prev.date=new Date(e.prev.date),e.premiered=new Date(e.premiered),x.push(e)})),w(),r.onsubmit=S):r.onsubmit=function(){return S(),T.timeout((function(){return x.length&&w()&&(r.onsubmit=S)}),3),!1},g.setup(document.body)}()}}]);